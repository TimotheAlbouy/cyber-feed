<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <title>Connexion</title>
    <script src="util.js"></script>
  </head>

  <body>
    <header>
      <div><a href="index.html">Accueil</a></div>
      <div><a href="register.html">S'inscrire</a></div>
    </header>

    <div>
      <label for="username">Nom d'utilisateur :</label>
      <input type="text" id="username" />
      <br/>
      <label for="password">Mot de passe :</label>
      <input type="password" id="password" />
      <br/>
      <button onclick="login()">Connexion</button>
    </div>
    
    <div id="message"></div>

    <footer>
      Merci de contacter l'ENSIBS pour plus de renseignements.
    </footer>

    <script>
    function login() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const params = {
        username: username,
        password: password
      };
      
      apiRequest("POST", "login.php", params, null, res => {
        const jsonRes = JSON.parse(res.responseText);
        setToken(jsonRes.token);
        document.getElementById("message").innerHTML = "Connexion rÃ©ussie.";
      }, err => {
        document.getElementById("message").innerHTML = "Echec de la connexion.";
      });
    }
    </script>
  </body>
</html>